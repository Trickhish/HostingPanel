<div class="websites-container">
  <!-- Header -->
  <div class="page-header">
    <div>
      <h1>Sites Web</h1>
      <p>Gérez tous vos sites WordPress</p>
    </div>
    <button class="btn-primary" (click)="openCreateModal()">
      <i class="fa-solid fa-plus"></i>
      Nouveau Site
    </button>
  </div>

  <!-- Stats -->
  <div class="stats-row">
    <div class="stat-item">
      <span class="stat-value">{{ websiteStats.total }}</span>
      <span class="stat-label">Total</span>
    </div>
    <div class="stat-item active">
      <span class="stat-value">{{ websiteStats.active }}</span>
      <span class="stat-label">Actifs</span>
    </div>
    <div class="stat-item installing">
      <span class="stat-value">{{ websiteStats.installing }}</span>
      <span class="stat-label">Installation</span>
    </div>
    <div class="stat-item suspended">
      <span class="stat-value">{{ websiteStats.suspended }}</span>
      <span class="stat-label">Suspendus</span>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-bar">
    <div class="search-box">
      <i class="fa-solid fa-search"></i>
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (ngModelChange)="onSearchChange()"
        placeholder="Rechercher un site...">
    </div>

    <div class="filter-group">
      <label>Statut:</label>
      <select [(ngModel)]="statusFilter" (ngModelChange)="onStatusFilterChange()">
        <option value="all">Tous</option>
        <option value="active">Actifs</option>
        <option value="installing">Installation</option>
        <option value="suspended">Suspendus</option>
        <option value="error">Erreur</option>
      </select>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Chargement des sites...</p>
  </div>

  <!-- Websites Grid -->
  <div class="websites-grid" *ngIf="!isLoading && filteredWebsites.length > 0">
    <div class="website-card" *ngFor="let website of filteredWebsites">
      <div class="website-card-header">
        <div class="website-icon">
          <i class="fa-solid fa-globe"></i>
        </div>
        <div class="website-status" [ngClass]="getStatusClass(website.status)">
          <i class="fa-solid" [ngClass]="getStatusIcon(website.status)"></i>
          {{ website.status }}
        </div>
      </div>

      <div class="website-card-body">
        <h3>{{ website.name }}</h3>
        <p class="website-path">{{ website.site_path }}</p>

        <div class="website-stats">
          <div class="stat">
            <i class="fa-solid fa-hard-drive"></i>
            <span>{{ formatBytes(website.disk_usage) }}</span>
          </div>
          <div class="stat" *ngIf="website.last_backup_at">
            <i class="fa-solid fa-cloud-arrow-up"></i>
            <span>{{ website.last_backup_at | date:'short' }}</span>
          </div>
        </div>
      </div>

      <div class="website-card-footer">
        <button class="btn-secondary" [routerLink]="['/websites', website.id]">
          <i class="fa-solid fa-eye"></i>
          Voir
        </button>
        <button class="btn-secondary">
          <i class="fa-solid fa-cog"></i>
          Gérer
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && filteredWebsites.length === 0 && websites.length === 0">
    <i class="fa-solid fa-globe"></i>
    <h3>Aucun site web</h3>
    <p>Commencez par créer votre premier site WordPress</p>
    <button class="btn-primary" (click)="openCreateModal()">
      <i class="fa-solid fa-plus"></i>
      Créer un site
    </button>
  </div>

  <!-- No Results -->
  <div class="empty-state" *ngIf="!isLoading && filteredWebsites.length === 0 && websites.length > 0">
    <i class="fa-solid fa-search"></i>
    <h3>Aucun résultat</h3>
    <p>Aucun site ne correspond à vos critères de recherche</p>
  </div>
</div>

<!-- Create Website Modal -->
<div class="modal-overlay" *ngIf="showCreateModal" (click)="closeCreateModal()">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Créer un nouveau site</h2>
      <button class="close-btn" (click)="closeCreateModal()">
        <i class="fa-solid fa-times"></i>
      </button>
    </div>

    <div class="modal-body">
      <form (ngSubmit)="createWebsite()">
        <div class="form-group">
          <label>Nom du site *</label>
          <input
            type="text"
            [(ngModel)]="newWebsite.name"
            name="name"
            placeholder="Mon Site WordPress"
            required>
        </div>

        <div class="form-group">
          <label>Domaine</label>
          <input
            type="text"
            [(ngModel)]="newWebsite.domain"
            name="domain"
            placeholder="monsite.com">
          <small>Laissez vide pour utiliser un sous-domaine temporaire</small>
        </div>

        <div class="form-group">
          <label>Version PHP</label>
          <select [(ngModel)]="newWebsite.phpVersion" name="phpVersion">
            <option value="7.4">PHP 7.4</option>
            <option value="8.0">PHP 8.0</option>
            <option value="8.1">PHP 8.1</option>
            <option value="8.2">PHP 8.2</option>
            <option value="8.3">PHP 8.3</option>
          </select>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="closeCreateModal()">
            Annuler
          </button>
          <button type="submit" class="btn-primary">
            <i class="fa-solid fa-plus"></i>
            Créer le site
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
