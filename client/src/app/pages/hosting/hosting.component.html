<div class="hosting-container">
  <!-- Header -->
  <div class="page-header">
    <div>
      <h1>{{ 'hosting.title' | translate }}</h1>
      <p>{{ 'hosting.subtitle' | translate }}</p>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>{{ 'common.loading' | translate }}...</p>
  </div>

  <div *ngIf="!isLoading">
    <!-- Current Plan Overview -->
    <div class="current-plan-card">
      <div class="plan-header">
        <div>
          <span class="plan-badge">{{ 'hosting.currentPlan' | translate }}</span>
          <h2>{{ currentPlan.name }}</h2>
          <p class="plan-price">{{ currentPlan.price }}€ <span>{{ 'hosting.perMonth' | translate }}</span></p>
        </div>
        <button class="btn-upgrade">
          <i class="fa-solid fa-arrow-up"></i>
          {{ 'hosting.upgrade' | translate }}
        </button>
      </div>

      <!-- Usage Stats -->
      <div class="usage-grid">
        <!-- Websites Usage -->
        <div class="usage-card">
          <div class="usage-header">
            <div class="usage-icon websites">
              <i class="fa-solid fa-globe"></i>
            </div>
            <div class="usage-info">
              <h3>{{ 'hosting.usage.websites' | translate }}</h3>
              <p>{{ currentPlan.currentUsage.websites }} / {{ currentPlan.features.websites }}</p>
            </div>
          </div>
          <div class="progress-bar">
            <div
              class="progress-fill"
              [ngClass]="getUsageClass(getUsagePercentage(currentPlan.currentUsage.websites, currentPlan.features.websites))"
              [style.width.%]="getUsagePercentage(currentPlan.currentUsage.websites, currentPlan.features.websites)">
            </div>
          </div>
          <span class="usage-percentage">
            {{ getUsagePercentage(currentPlan.currentUsage.websites, currentPlan.features.websites).toFixed(0) }}% {{ 'hosting.usage.used' | translate }}
          </span>
        </div>

        <!-- Storage Usage -->
        <div class="usage-card">
          <div class="usage-header">
            <div class="usage-icon storage">
              <i class="fa-solid fa-hard-drive"></i>
            </div>
            <div class="usage-info">
              <h3>{{ 'hosting.usage.storage' | translate }}</h3>
              <p>{{ currentPlan.currentUsage.storage.toFixed(2) }} GB / {{ currentPlan.features.storage }} GB</p>
            </div>
          </div>
          <div class="progress-bar">
            <div
              class="progress-fill"
              [ngClass]="getUsageClass(getUsagePercentage(currentPlan.currentUsage.storage, currentPlan.features.storage))"
              [style.width.%]="getUsagePercentage(currentPlan.currentUsage.storage, currentPlan.features.storage)">
            </div>
          </div>
          <span class="usage-percentage">
            {{ getUsagePercentage(currentPlan.currentUsage.storage, currentPlan.features.storage).toFixed(0) }}% {{ 'hosting.usage.used' | translate }}
          </span>
        </div>

        <!-- Bandwidth Usage -->
        <div class="usage-card">
          <div class="usage-header">
            <div class="usage-icon bandwidth">
              <i class="fa-solid fa-arrow-right-arrow-left"></i>
            </div>
            <div class="usage-info">
              <h3>{{ 'hosting.usage.bandwidth' | translate }}</h3>
              <p>{{ currentPlan.currentUsage.bandwidth.toFixed(2) }} GB / {{ currentPlan.features.bandwidth }} GB</p>
            </div>
          </div>
          <div class="progress-bar">
            <div
              class="progress-fill"
              [ngClass]="getUsageClass(getUsagePercentage(currentPlan.currentUsage.bandwidth, currentPlan.features.bandwidth))"
              [style.width.%]="getUsagePercentage(currentPlan.currentUsage.bandwidth, currentPlan.features.bandwidth)">
            </div>
          </div>
          <span class="usage-percentage">
            {{ getUsagePercentage(currentPlan.currentUsage.bandwidth, currentPlan.features.bandwidth).toFixed(0) }}% {{ 'hosting.usage.used' | translate }}
          </span>
        </div>
      </div>

      <!-- Features List -->
      <div class="features-list">
        <h3>{{ 'hosting.features.title' | translate }}</h3>
        <div class="features-grid">
          <div class="feature-item">
            <i class="fa-solid fa-check"></i>
            <span>{{ 'hosting.features.freeSSL' | translate }}</span>
          </div>
          <div class="feature-item">
            <i class="fa-solid fa-check"></i>
            <span>{{ 'hosting.features.dailyBackups' | translate }}</span>
          </div>
          <div class="feature-item">
            <i class="fa-solid fa-check"></i>
            <span>{{ 'hosting.features.support' | translate }} {{ currentPlan.features.support }}</span>
          </div>
          <div class="feature-item">
            <i class="fa-solid fa-check"></i>
            <span>{{ 'hosting.features.autoUpdates' | translate }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Available Plans -->
    <div class="plans-section">
      <h2>{{ 'hosting.plans.title' | translate }}</h2>
      <p>{{ 'hosting.plans.subtitle' | translate }}</p>

      <div class="plans-grid">
        <div
          class="plan-card"
          *ngFor="let plan of availablePlans"
          [ngClass]="{'current': isCurrentPlan(plan), 'popular': plan.name === 'Professional'}">

          <div class="plan-badge-container">
            <span class="current-badge" *ngIf="isCurrentPlan(plan)">{{ 'hosting.plans.current' | translate }}</span>
            <span class="popular-badge" *ngIf="plan.name === 'Professional'">{{ 'hosting.plans.popular' | translate }}</span>
          </div>

          <h3>{{ plan.name }}</h3>
          <div class="plan-price-large">
            <span class="price">{{ plan.price }}€</span>
            <span class="period">{{ 'hosting.perMonth' | translate }}</span>
          </div>

          <ul class="plan-features">
            <li>
              <i class="fa-solid fa-check"></i>
              <span>{{ plan.features.websites }} {{ 'hosting.plans.websitesCount' | translate }}</span>
            </li>
            <li>
              <i class="fa-solid fa-check"></i>
              <span>{{ plan.features.storage }} GB {{ 'hosting.plans.storageUnit' | translate }}</span>
            </li>
            <li>
              <i class="fa-solid fa-check"></i>
              <span>{{ plan.features.bandwidth }} GB {{ 'hosting.plans.bandwidthUnit' | translate }}</span>
            </li>
            <li>
              <i class="fa-solid fa-check"></i>
              <span>{{ 'hosting.features.freeSSL' | translate }}</span>
            </li>
            <li>
              <i class="fa-solid fa-check"></i>
              <span>{{ 'hosting.features.dailyBackups' | translate }}</span>
            </li>
            <li>
              <i class="fa-solid fa-check"></i>
              <span>{{ 'hosting.features.support' | translate }} {{ plan.features.support }}</span>
            </li>
          </ul>

          <button
            class="btn-select-plan"
            [ngClass]="{'current': isCurrentPlan(plan)}"
            [disabled]="isCurrentPlan(plan)">
            <span *ngIf="isCurrentPlan(plan)">{{ 'hosting.plans.currentPlan' | translate }}</span>
            <span *ngIf="!isCurrentPlan(plan)">{{ 'hosting.plans.selectPlan' | translate }}</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Billing Information -->
    <div class="billing-section">
      <h2>{{ 'hosting.billing.title' | translate }}</h2>
      <div class="billing-card">
        <div class="billing-item">
          <span class="label">{{ 'hosting.billing.nextPayment' | translate }}</span>
          <strong>{{ getNextPaymentDate() | date:'d MMMM yyyy' }}</strong>
        </div>
        <div class="billing-item">
          <span class="label">{{ 'hosting.billing.amount' | translate }}</span>
          <strong>{{ currentPlan.price }}€</strong>
        </div>
        <div class="billing-item">
          <span class="label">{{ 'hosting.billing.paymentMethod' | translate }}</span>
          <strong>•••• •••• •••• 4242</strong>
        </div>
        <div class="billing-actions">
          <button class="btn-secondary">
            <i class="fa-solid fa-credit-card"></i>
            {{ 'hosting.billing.changeCard' | translate }}
          </button>
          <button class="btn-secondary">
            <i class="fa-solid fa-file-invoice"></i>
            {{ 'hosting.billing.viewInvoices' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
